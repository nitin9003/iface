/*

Quicksand 1.2.2

Reorder and filter items with a nice shuffling animation.

Copyright (c) 2010 Jacek Galanciak (razorjack.net) and agilope.com
Big thanks for Piotr Petrus (riddle.pl) for deep code review and wonderful docs & demos.

Dual licensed under the MIT and GPL version 2 licenses.
http://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt
http://github.com/jquery/jquery/blob/master/GPL-LICENSE.txt

Project site: http://razorjack.net/quicksand
Github site: http://github.com/razorjack/quicksand

*/
(function(t){t.fn.quicksand=function(e,n){var i={duration:750,easing:"swing",attribute:"data-id",adjustHeight:"auto",useScaling:!0,enhancement:function(){},selector:"> *",dx:0,dy:0};t.extend(i,n),(t.browser.msie||"undefined"==typeof t.fn.scale)&&(i.useScaling=!1);var o;if("function"==typeof arguments[1])var o=arguments[1];else var o=arguments[2];return this.each(function(n){var r,a,s=[],l=t(e).clone(),c=t(this),u=t(this).css("height"),f=!1,h=t(c).offset(),p=[],m=t(this).find(i.selector);if(t.browser.msie&&7>t.browser.version.substr(0,1))return c.html("").append(l),void 0;var g=0,v=function(){g||(g=1,$toDelete=c.find("> *"),c.prepend(C.find("> *")),$toDelete.remove(),f&&c.css("height",a),i.enhancement(c),"function"==typeof o&&o.call(this))},y=c.offsetParent(),b=y.offset();"relative"==y.css("position")?"body"==y.get(0).nodeName.toLowerCase()||(b.top+=parseFloat(y.css("border-top-width"))||0,b.left+=parseFloat(y.css("border-left-width"))||0):(b.top-=parseFloat(y.css("border-top-width"))||0,b.left-=parseFloat(y.css("border-left-width"))||0,b.top-=parseFloat(y.css("margin-top"))||0,b.left-=parseFloat(y.css("margin-left"))||0),isNaN(b.left)&&(b.left=0),isNaN(b.top)&&(b.top=0),b.left-=i.dx,b.top-=i.dy,c.css("height",t(this).height()),m.each(function(e){p[e]=t(this).offset()}),t(this).stop();var x=0,w=0;m.each(function(e){t(this).stop();var n=t(this).get(0);"absolute"==n.style.position?(x=-i.dx,w=-i.dy):(x=i.dx,w=i.dy),n.style.position="absolute",n.style.margin="0",n.style.top=p[e].top-parseFloat(n.style.marginTop)-b.top+w+"px",n.style.left=p[e].left-parseFloat(n.style.marginLeft)-b.left+x+"px"});var C=t(c).clone(),T=C.get(0);for(T.innerHTML="",T.setAttribute("id",""),T.style.height="auto",T.style.width=c.width()+"px",C.append(l),C.insertBefore(c),C.css("opacity",0),T.style.zIndex=-1,T.style.margin="0",T.style.position="absolute",T.style.top=h.top-b.top+"px",T.style.left=h.left-b.left+"px","dynamic"===i.adjustHeight?c.animate({height:C.height()},i.duration,i.easing):"auto"===i.adjustHeight&&(a=C.height(),parseFloat(u)<parseFloat(a)?c.css("height",a):f=!0),m.each(function(){var e=[];"function"==typeof i.attribute?(r=i.attribute(t(this)),l.each(function(){return i.attribute(this)==r?(e=t(this),!1):void 0})):e=l.filter("["+i.attribute+"="+t(this).attr(i.attribute)+"]"),e.length?i.useScaling?s.push({element:t(this),animation:{top:e.offset().top-b.top,left:e.offset().left-b.left,opacity:1,scale:"1.0"}}):s.push({element:t(this),animation:{top:e.offset().top-b.top,left:e.offset().left-b.left,opacity:1}}):i.useScaling?s.push({element:t(this),animation:{opacity:"0.0",scale:"0.0"}}):s.push({element:t(this),animation:{opacity:"0.0"}})}),l.each(function(){var e=[],n=[];"function"==typeof i.attribute?(r=i.attribute(t(this)),m.each(function(){return i.attribute(this)==r?(e=t(this),!1):void 0}),l.each(function(){return i.attribute(this)==r?(n=t(this),!1):void 0})):(e=m.filter("["+i.attribute+"="+t(this).attr(i.attribute)+"]"),n=l.filter("["+i.attribute+"="+t(this).attr(i.attribute)+"]"));var o;if(0===e.length){o=i.useScaling?{opacity:"1.0",scale:"1.0"}:{opacity:"1.0"},d=n.clone();var a=d.get(0);a.style.position="absolute",a.style.margin="0",a.style.top=n.offset().top-b.top+"px",a.style.left=n.offset().left-b.left+"px",d.css("opacity",0),i.useScaling&&d.css("transform","scale(0.0)"),d.appendTo(c),s.push({element:t(d),animation:o})}}),C.remove(),i.enhancement(c),n=0;s.length>n;n++)s[n].element.animate(s[n].animation,i.duration,i.easing,v)})}})(jQuery);